:root{--color-accent:oklch(65% 0.5 0)}
html{accent-color:var(--color-accent);color-scheme:light dark;background:canvas;color:canvastext}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{
  font:100%/1.5 system-ui;
  max-width:100ch;
  margin-inline:max(1em,(100% - 100ch)/2);
  margin-block:0;
  background:canvas;
  color:canvastext;
}
.site-nav>ul,.site-nav>ul>li{display:contents}

/* headers/nav with scheme-aware borders/backgrounds */
.site-header,.site-nav{--border-color:color-mix(in oklch, canvastext 25%, canvas 75%)}
.site-header{border-bottom:1px solid var(--border-color);background:canvas}
.site-nav{
  display:flex;gap:0;max-width:100%;
  padding:.75rem 0;margin:0;
  border-bottom:1px solid var(--border-color);
  background:canvas
}
.site-nav a{flex:1;text-decoration:none;color:inherit;text-align:center;padding:.5em .75em;border-bottom:0 solid transparent}
.site-nav a.current{border-bottom:.4em solid var(--border-color);padding-bottom:.3em}
.site-nav a:hover{border-bottom:.4em solid var(--color-accent);background:color-mix(in oklch, var(--color-accent), canvas 85%)}

main{padding:0 1rem}
.lead{font-size:1.125rem}
.hero{margin:1.5rem 0}
.hero img{width:50%;max-width:100%;height:auto;display:block;margin:1rem auto;border-radius:.75rem;box-shadow:0 2px 14px rgba(0,0,0,.06)}
h1,h2,h3{line-height:1.1;margin:1.25rem 0 .5rem}
h1{font-size:400%;text-wrap:balance}
p,ul,ol,figure{margin:.75rem 0 1rem}
ul{padding-left:1.25rem}

/* form + controls honor theme */
input,textarea,button,select{font:inherit;color:canvastext}
input,textarea,select{
  background:canvas;
  border:1px solid color-mix(in oklch, canvastext 20%, canvas 80%);
  border-radius:.5rem;
}
form{display:grid;grid-template-columns:auto 1fr;gap:1em}
form>label{display:grid;grid-template-columns:subgrid;grid-column:1/-1;align-items:start;gap:.5em}
form>label>input,form>label>textarea{grid-column:2;width:100%;box-sizing:border-box;padding:.6rem .7rem}
form>button{
  grid-column:1/-1;justify-self:start;padding:.6rem .9rem;
  border:1px solid currentColor;background:currentColor;color:canvas;border-radius:.5rem;cursor:pointer
}

/* projects layout (no overlap) */
.projects{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(15em,1fr));
  gap:1em;
  margin-block:1rem;
}
.projects>article{
  display:flex;flex-direction:column;gap:.5em;
  padding:.75rem;border:1px solid color-mix(in oklch, canvastext 15%, canvas 85%);
  border-radius:.5rem;background:canvas
}
.projects h2{margin:0 0 .25rem}
.projects p{margin:0 0 .75rem}
.projects ul{margin:0;padding-left:1.25rem}

/* theme switcher */
.color-scheme{position:absolute;top:1rem;right:1rem;font-size:80%}
.color-scheme select{font:inherit}
/* GitHub stats grid */
.gh-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.5rem 1rem;
  align-items: baseline;
}

.gh-grid dt {
  grid-row: 1;
  font-weight: 600;
}

.gh-grid dd {
  grid-row: 2;
  margin: 0;
}

.profile-stats {
  margin-block: 1rem;
  padding: 0.75rem;
  border: 1px solid color-mix(in oklch, canvastext 15%, canvas 85%);
  border-radius: 0.5rem;
}

/* Lab 5: Pie layout */
.pie-wrap {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  margin-block: 1rem 1.5rem;
}

/* SVG size + overflow handling */
#projects-pie-plot {
  max-width: 20em;
  margin-block: 0.5rem;
  overflow: visible;
}

/* Legend styling */
.legend {
  list-style: none;
  padding: .75rem;
  margin: 0;
  border: 1px solid color-mix(in oklch, canvastext 15%, canvas 85%);
  border-radius: .5rem;

  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(9em, 1fr));
  gap: .75rem 1rem;
  flex: 1; /* take remaining width next to the pie */
}

.legend li {
  display: flex;
  align-items: center;
  gap: .5rem;
  padding: .25rem .5rem;
  border-radius: .375rem;
  background: color-mix(in oklch, canvas 96%, var(--color) 4%);
  transition: background 200ms, outline-color 200ms;
  outline: 1px solid transparent;
  cursor: pointer;
}

.legend li .swatch {
  width: 1em;
  aspect-ratio: 1 / 1;
  border-radius: .25em;
  display: inline-block;
  background: var(--color);
}

.legend li:hover {
  outline-color: color-mix(in oklch, var(--color) 40%, canvas 60%);
}

/* Hover effect for pie using :has */
#projects-pie-plot:has(path:hover) path:not(:hover) {
  opacity: 0.5;
}

#projects-pie-plot path {
  cursor: pointer;
  transition: 300ms;
}

/* Selected slice / legend item */
.selected {
  --color: oklch(60% 0.45 0) !important; /* highlight color */
}
#projects-pie-plot path.selected { fill: var(--color); }
.legend li.selected {
  outline-color: var(--color);
  background: color-mix(in oklch, var(--color) 10%, canvas 90%);
}

/* Projects page controls */
.projects-controls {
  margin-block: 1rem;
}
.searchBar {
  width: min(40rem, 100%);
  padding: .5rem .75rem;
  border-radius: .5rem;
  border: 1px solid color-mix(in oklch, canvastext 15%, canvas 85%);
  background: canvas;
  color: canvastext;
}

/* Year under description */
.project-body { display: grid; gap: .35rem; }
.project-year {
  color: oklch(45% 0 0);
  font-family: Baskerville, Georgia, 'Times New Roman', serif;
  font-variant-numeric: oldstyle-nums;
  margin: 0;
  line-height: 1.2;
}
/* Meta: tooltip + info list */
dl.info{display:grid;grid-template-columns:auto 1fr;gap:.25rem .75rem;margin:.5rem 0}
dl.info dt{opacity:.7}
.tooltip{position:fixed;top:1em;left:1em;padding:.6rem .8rem;border:1px solid color-mix(in oklch, canvastext 20%, canvas 80%);border-radius:.5rem;background:color-mix(in oklch, canvas 92%, canvastext 8%);box-shadow:0 4px 18px rgba(0,0,0,.12);backdrop-filter:saturate(1.1) blur(4px);z-index:1000;pointer-events:none}
dl.info{transition:opacity .5s,visibility .5s}
dl.info[hidden]:not(:hover,:focus-within){opacity:0;visibility:hidden}

/* Scatterplot dots hover */
#chart circle{transition:200ms;transform-origin:center;transform-box:fill-box}
#chart circle:hover{transform:scale(1.5)}

/* Gridlines */
.gridlines line{stroke:color-mix(in oklch, canvastext 20%, canvas 80%);stroke-opacity:.35}
.gridlines path{display:none}

/* Brushing */
.selection{fill-opacity:.1;stroke:black;stroke-opacity:.7;stroke-dasharray:5 3;animation:marching-ants 2s linear infinite}
@keyframes marching-ants{to{stroke-dashoffset:-8}}
#chart circle.selected{fill:#ff6b6b}
